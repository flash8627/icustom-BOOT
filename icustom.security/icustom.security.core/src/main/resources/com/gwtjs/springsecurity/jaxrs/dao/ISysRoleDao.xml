<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gwtjs.icustom.springsecurity.jaxrs.dao.ISysRoleDao">
	
	<select id="findAll" resultType="com.gwtjs.icustom.springsecurity.entity.SysRole">
		SELECT
			  *
			FROM sys_role_t sr WHERE sr.valid_flag = 1 
	</select>
	
	<select id="findByRoleName" resultType="com.gwtjs.icustom.springsecurity.entity.SysRole">
		SELECT
			  *
			FROM sys_role_t sr 
			WHERE sr.valid_flag = 1 
			AND sr.ROLE_NAME = #{rolename,jdbcType=VARCHAR}
	</select>
	
	<select id="findRoleIdCount" resultType="int">
		SELECT max(sr.id)+1 FROM  sys_role_t sr WHERE sr.valid_flag = 1 
	</select>
	
	<insert id="insert">
		INSERT INTO sys_role_t (id, ROLE_NAME,uid)
			VALUES (#{id,jdbcType=NUMERIC} , #{rolename,jdbcType=VARCHAR},#{userId,jdbcType=NUMERIC}) 
	</insert>
	
	<delete id="delete">
		DELETE
			FROM sys_role_t
			WHERE id = #{id,jdbcType=NUMERIC} 
	</delete>
	
	<update id="update">
		UPDATE sys_role_t sr 
			SET 
			  sr.ROLE_NAME = #{rolename,jdbcType=VARCHAR} 
			WHERE sr.valid_flag = 1 
			id = #{id,jdbcType=NUMERIC}  
	</update>
	
	<select id="findRolePageCount" resultType="int">
		SELECT 
			  COUNT(1)  
			FROM sys_role_t  sr WHERE sr.valid_flag = 1 
	</select>
	
	<select id="findRolePage" resultType="com.gwtjs.icustom.springsecurity.entity.SysRole">
		<include refid="select_base" />
		LIMIT #{page.startIndex} , #{page.endIndex} 
	</select>
	
	<sql id="select_base">
		SELECT
			  ROLE_ID id,
			  ROLE_NAME rolename,
			  USER_ID uid 
			FROM sys_role_t sr
	</sql>
	
	<sql id="select_cond">
		<if test='_parameter.get("vo").account != null and _parameter.get("vo").account != "" and _parameter.get("vo").account != "null"'>
			AND upper(sr.account) = upper(#{vo.account,jdbcType=VARCHAR}) 
		</if>
		<if test='_parameter.get("vo").username != null and _parameter.get("vo").username != "" and _parameter.get("vo").username != "null"'>
			AND upper(sr.username) = upper(#{vo.username,jdbcType=VARCHAR}) 
		</if>
	</sql>
	
</mapper>