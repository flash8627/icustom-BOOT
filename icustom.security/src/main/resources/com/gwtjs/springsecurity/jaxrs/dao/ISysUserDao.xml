<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gwtjs.springsecurity.jaxrs.dao.ISysUserDao">

	<select id="findAllUserList" resultType="com.gwtjs.springsecurity.entity.SysUser">
		<include refid="Base_Column_List" /> 
	</select>
	
	<select id="findUserList" resultType="com.gwtjs.springsecurity.entity.SysUser">
		<include refid="Base_Column_List" /> 
		<include refid="select_cond" /> 
		<!-- AND name = #{param1.name}
		AND email = #{param1.email}
		AND #{param2.curPage} = #{param2.curPage} 
		AND #{param2.pageSize} = #{param2.pageSize} 
		 AND #{param2.endIndex} = #{param2.endIndex} 
		AND #{param2.startIndex} = #{param2.startIndex} 
		 -->
		<!-- AND #{param2.mysqlStartIndex} = #{param2.mysqlEndIndex}  -->
		LIMIT #{param2.startIndex} , #{param2.endIndex} 
	</select>
	
	<select id="findUser" resultType="com.gwtjs.springsecurity.entity.SysUser">
		<include refid="Base_Column_List" /> 
		 AND id=#{id,jdbcType=INTEGER} 
	</select>
	
	<select id="findUserByname" resultType="com.gwtjs.springsecurity.entity.SysUser">
		<include refid="Base_Column_List" /> 
		 AND upper(name)=upper(#{name,jdbcType=VARCHAR})
	</select>
	
	<sql id="select_cond">
		<if test='_parameter.get("param1").name != null and _parameter.get("param1").name != "" and _parameter.get("param1").name != "null"'>
			AND upper(T1.name) = upper(#{param1.name,jdbcType=VARCHAR}) 
		</if>
	</sql>
		
	<sql id="Base_Column_List">
		SELECT id id, name name, 
		email email, dob dob FROM sys_user T1 WHERE 1=1 
	</sql>
	
	<select id="findUserIdCount" resultType="int">
		SELECT max(T1.id)+1 FROM  sys_user T1
	</select>
	
	<insert id="update">
		UPDATE sys_user
		SET 
		name=#{name,jdbcType=VARCHAR},
		email=#{email,jdbcType=VARCHAR}
		where id=#{id,jdbcType=INTEGER}
	</insert>
	
	<insert id="insert">
		INSERT into sys_user(id,name,email,password,dob) 
		values(
		#{id,jdbcType=INTEGER},
		#{name,jdbcType=VARCHAR},
		#{email,jdbcType=VARCHAR},
		#{password,jdbcType=VARCHAR},
		#{dob,jdbcType=VARCHAR}) 
	</insert>
	
	<insert id="batchInsert">
		declare
		<if test="list!=null and !list.isEmpty()">
			begin
			<foreach collection="list" item="item">
				INSERT into sys_user(id,name,email,password) values(#{item.id,jdbcType=INTEGER},#{item.name,jdbcType=VARCHAR},#{item.email,jdbcType=VARCHAR},#{item.password,jdbcType=VARCHAR});
			</foreach>
			end;
		</if>
	</insert>

</mapper>